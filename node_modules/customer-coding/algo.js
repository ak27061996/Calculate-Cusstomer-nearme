/*
Author: Anil Kumar
Date: Sunday 12 May 2019s
*/


//return customer whose distance < = dist 
function Algo(curr_lat=0,curr_lon=0,cust=[],dist=100) {
	var res=[];
	for(var i=0;i<cust.length;i++){
		let distres = DistanceBW(curr_lat,curr_lon,cust[i].latitude,cust[i].longitude);
		if(distres<=dist ){
			cust[i].dist_from_given_point=distres;
			res.push(cust[i]);
		}
	}
	return res;
}


//function: return  distance between two point (points contains longitude and latitude) in Km
function DistanceBW(lat1,lon1,lat2,lon2) {
	lat1 = parseFloat(lat1);
	lon1 = parseFloat(lon1);
	lat2 = parseFloat(lat2);
	lon2 = parseFloat(lon2);
  	var R = 6371; // Radius of the earth in km
  	var dLat = deg2rad(lat2-lat1);  // deg2rad below
  	var dLon = deg2rad(lon2-lon1); 
  	var a = 
    	Math.sin(dLat/2) * Math.sin(dLat/2) +
    	Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
    	Math.sin(dLon/2) * Math.sin(dLon/2);

  	var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
  	var d = R * c; // Distance in km
  	return d;
}

function deg2rad(deg) {
  return deg * (Math.PI/180)
}


module.exports=Algo;